import{s as e,j as s}from"./index-BH-fJ4Ku.js";import{c as t,L as r}from"./react-vendor-Bx1kqAC_.js";import"./supabase-vendor-Bh6n7b__.js";function a(){const[a,l]=t.useState([]),[n,o]=t.useState(!1),[c,d]=t.useState(""),[x,m]=t.useState("all"),[h,g]=t.useState("all"),[u,p]=t.useState(!1),[b,f]=t.useState(null),[j,v]=t.useState(new Set),[y,N]=t.useState(1),[w,S]=t.useState(!0),k=[{id:"all",name:"Todas as Categorias"},{id:"web-development",name:"Desenvolvimento Web"},{id:"ecommerce",name:"E-commerce"},{id:"business-tools",name:"Ferramentas de NegÃ³cio"},{id:"automation",name:"AutomaÃ§Ã£o"},{id:"optimization",name:"OtimizaÃ§Ã£o"},{id:"consulting",name:"Consultoria"}];t.useEffect(()=>{A(),C()},[]);const C=async()=>{try{const{data:s}=await e.from("tax_settings").select("is_active").eq("rule_name","Global VAT").single();s&&S(s.is_active)}catch(s){}},A=async()=>{o(!0);try{const{data:s,error:t}=await e.from("services").select("*").order("created_at",{ascending:!1});if(t)throw t;l(s||[])}catch(s){}finally{o(!1)}},z=a.filter(e=>{const s=e.title||"",t=e.description||"",r=c.toLowerCase(),a=s.toLowerCase().includes(r)||t.toLowerCase().includes(r),i="all"===x||e.category===x,l="all"===h||"active"===h&&e.active||"inactive"===h&&!e.active;return a&&i&&l}),_=Math.ceil(z.length/12),q=12*(y-1),E=q+12,P=z.slice(q,E);t.useEffect(()=>{N(1)},[c,x,h]);const M=()=>{f(null),p(!0)};return s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"GestÃ£o de ServiÃ§os"}),s.jsx("p",{className:"text-gray-600 mt-1",children:"Gerir serviÃ§os profissionais oferecidos"})]}),s.jsxs("div",{className:"flex items-center gap-3",children:[j.size>0&&s.jsxs("button",{onClick:async()=>{if(0!==j.size&&confirm(`Tem certeza que deseja excluir ${j.size} serviÃ§o(s)?`)){o(!0);try{const{error:s}=await e.from("services").delete().in("id",Array.from(j));if(s)throw s;v(new Set),await A()}catch(s){alert("Erro ao excluir serviÃ§os")}finally{o(!1)}}},className:"px-6 py-3 bg-red-500 text-white font-semibold rounded-lg hover:bg-red-600 transition-all duration-300 shadow-md hover:shadow-lg flex items-center gap-2 whitespace-nowrap cursor-pointer",children:[s.jsx("i",{className:"ri-delete-bin-line text-xl"}),"Excluir (",j.size,")"]}),s.jsxs("button",{onClick:M,className:"px-6 py-3 bg-gradient-to-r from-amber-500 to-amber-600 text-white font-semibold rounded-lg hover:from-amber-600 hover:to-amber-700 transition-all duration-300 shadow-md hover:shadow-lg flex items-center gap-2 whitespace-nowrap cursor-pointer",children:[s.jsx("i",{className:"ri-add-line text-xl"}),"Adicionar ServiÃ§o"]})]})]}),s.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:s.jsxs("div",{className:"grid md:grid-cols-3 gap-4",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Pesquisar ServiÃ§os"}),s.jsxs("div",{className:"relative",children:[s.jsx("i",{className:"ri-search-line absolute left-3 top-1/2 -translate-y-1/2 text-gray-400"}),s.jsx("input",{type:"text",value:c,onChange:e=>d(e.target.value),placeholder:"Nome ou descriÃ§Ã£o...",className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-amber-500 focus:border-transparent text-sm"})]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Categoria"}),s.jsx("select",{value:x,onChange:e=>m(e.target.value),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-amber-500 focus:border-transparent text-sm cursor-pointer",children:k.map(e=>s.jsx("option",{value:e.id,children:e.name},e.id))})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Status"}),s.jsx("select",{value:h,onChange:e=>g(e.target.value),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-amber-500 focus:border-transparent text-sm cursor-pointer",children:[{id:"all",name:"Todos os Status"},{id:"active",name:"Ativos"},{id:"inactive",name:"Inativos"}].map(e=>s.jsx("option",{value:e.id,children:e.name},e.id))})]})]})}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6",children:[s.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-sm text-gray-600",children:"Total de ServiÃ§os"}),s.jsx("p",{className:"text-3xl font-bold text-gray-900 mt-1",children:a.length})]}),s.jsx("div",{className:"w-12 h-12 flex items-center justify-center bg-amber-100 text-amber-600 rounded-lg",children:s.jsx("i",{className:"ri-service-line text-2xl"})})]})}),s.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-sm text-gray-600",children:"ServiÃ§os Ativos"}),s.jsx("p",{className:"text-3xl font-bold text-green-600 mt-1",children:a.filter(e=>e.active).length})]}),s.jsx("div",{className:"w-12 h-12 flex items-center justify-center bg-green-100 text-green-600 rounded-lg",children:s.jsx("i",{className:"ri-check-line text-2xl"})})]})}),s.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-sm text-gray-600",children:"Em Destaque"}),s.jsx("p",{className:"text-3xl font-bold text-blue-600 mt-1",children:a.filter(e=>e.featured).length})]}),s.jsx("div",{className:"w-12 h-12 flex items-center justify-center bg-blue-100 text-blue-600 rounded-lg",children:s.jsx("i",{className:"ri-star-line text-2xl"})})]})}),s.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-sm text-gray-600",children:"PreÃ§o MÃ©dio"}),s.jsxs("p",{className:"text-3xl font-bold text-purple-600 mt-1",children:["â‚¬",a.length>0?(a.reduce((e,s)=>e+s.price,0)/a.length).toFixed(0):0]})]}),s.jsx("div",{className:"w-12 h-12 flex items-center justify-center bg-purple-100 text-purple-600 rounded-lg",children:s.jsx("i",{className:"ri-money-euro-circle-line text-2xl"})})]})})]}),s.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 overflow-hidden",children:n?s.jsxs("div",{className:"text-center py-12",children:[s.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-amber-500 mx-auto mb-4"}),s.jsx("p",{className:"text-gray-500",children:"A carregar serviÃ§os..."})]}):0===z.length?s.jsxs("div",{className:"text-center py-12",children:[s.jsx("i",{className:"ri-service-line text-6xl text-gray-300 mb-4"}),s.jsx("p",{className:"text-gray-500 text-lg",children:"Nenhum serviÃ§o encontrado"}),s.jsx("button",{onClick:M,className:"mt-4 px-6 py-2 bg-amber-500 text-white rounded-lg hover:bg-amber-600 transition-colors cursor-pointer",children:"Adicionar Primeiro ServiÃ§o"})]}):s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"overflow-x-auto",children:s.jsxs("table",{className:"w-full",children:[s.jsx("thead",{className:"bg-gray-50 border-b border-gray-200",children:s.jsxs("tr",{children:[s.jsx("th",{className:"px-6 py-4 text-left",children:s.jsx("input",{type:"checkbox",checked:j.size===P.length&&P.length>0,onChange:()=>{j.size===P.length?v(new Set):v(new Set(P.map(e=>e.id)))},className:"w-4 h-4 text-amber-600 border-gray-300 rounded focus:ring-amber-500 cursor-pointer"})}),s.jsx("th",{className:"px-6 py-4 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider",children:"ServiÃ§o"}),s.jsx("th",{className:"px-6 py-4 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider",children:"Categoria"}),s.jsx("th",{className:"px-6 py-4 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider",children:"PreÃ§o"}),s.jsx("th",{className:"px-6 py-4 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider",children:"Prazo"}),s.jsx("th",{className:"px-6 py-4 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider",children:"Status"}),s.jsx("th",{className:"px-6 py-4 text-right text-xs font-semibold text-gray-600 uppercase tracking-wider",children:"AÃ§Ãµes"})]})}),s.jsx("tbody",{className:"divide-y divide-gray-200",children:P.map(t=>{const i=t.images&&t.images.length>0?t.images:t.image?[t.image]:[`https://readdy.ai/api/search-image?query=professional%20$%7Bservice.title%7D%20service%20illustration&width=400&height=300&seq=serv-${t.id}&orientation=landscape`];return s.jsxs("tr",{className:"hover:bg-gray-50 transition-colors",children:[s.jsx("td",{className:"px-6 py-4",children:s.jsx("input",{type:"checkbox",checked:j.has(t.id),onChange:()=>(e=>{const s=new Set(j);s.has(e)?s.delete(e):s.add(e),v(s)})(t.id),className:"w-4 h-4 text-amber-600 border-gray-300 rounded focus:ring-amber-500 cursor-pointer"})}),s.jsx("td",{className:"px-6 py-4",children:s.jsxs("div",{className:"flex items-center gap-4",children:[s.jsxs("div",{className:"relative w-16 h-16 rounded-lg overflow-hidden bg-gray-100 flex-shrink-0",children:[s.jsx("img",{src:i[0],alt:t.title,className:"w-full h-full object-cover"}),i.length>1&&s.jsxs("div",{className:"absolute bottom-1 right-1 px-1.5 py-0.5 bg-amber-500 text-white text-xs font-bold rounded",children:["ðŸ–¼ï¸ ",i.length]})]}),s.jsxs("div",{children:[s.jsx("p",{className:"font-semibold text-gray-900",children:t.title}),s.jsx("p",{className:"text-sm text-gray-500 line-clamp-1",children:t.short_description||t.description}),t.sku&&s.jsxs("p",{className:"text-xs text-gray-400 mt-1",children:["SKU: ",t.sku]})]})]})}),s.jsx("td",{className:"px-6 py-4",children:s.jsx("span",{className:"px-3 py-1 bg-gray-100 text-gray-700 rounded-full text-xs font-medium",children:k.find(e=>e.id===t.category)?.name||t.category})}),s.jsx("td",{className:"px-6 py-4",children:s.jsxs("div",{className:"flex flex-col",children:[s.jsxs("span",{className:"font-semibold text-gray-900",children:["â‚¬",t.price.toFixed(2)]}),t.vat_enabled&&t.price_with_vat&&s.jsxs("span",{className:"text-xs text-green-600",children:["c/ IVA: â‚¬",t.price_with_vat.toFixed(2)]})]})}),s.jsx("td",{className:"px-6 py-4 text-gray-600",children:t.delivery_time||"Sob consulta"}),s.jsx("td",{className:"px-6 py-4",children:s.jsx("button",{onClick:()=>(async s=>{o(!0);try{const t=a.find(e=>e.id===s);if(!t)return;const{error:r}=await e.from("services").update({active:!t.active}).eq("id",s);if(r)throw r;await A()}catch(t){alert("Erro ao alterar status")}finally{o(!1)}})(t.id),className:"px-3 py-1 rounded-full text-xs font-medium cursor-pointer "+(t.active?"bg-green-100 text-green-700":"bg-gray-100 text-gray-700"),children:t.active?"Ativo":"Inativo"})}),s.jsx("td",{className:"px-6 py-4",children:s.jsxs("div",{className:"flex items-center justify-end gap-2",children:[s.jsx(r,{to:`/services/${t.slug}`,target:"_blank",className:"w-8 h-8 flex items-center justify-center text-gray-600 hover:text-amber-600 hover:bg-amber-50 rounded-lg transition-colors cursor-pointer",title:"Ver ServiÃ§o",children:s.jsx("i",{className:"ri-eye-line"})}),s.jsx("button",{onClick:()=>(e=>{f(e),p(!0)})(t),className:"w-8 h-8 flex items-center justify-center text-gray-600 hover:text-blue-600 hover:bg-blue-50 rounded-lg transition-colors cursor-pointer",title:"Editar",children:s.jsx("i",{className:"ri-edit-line"})}),s.jsx("button",{onClick:()=>(async s=>{if(confirm("Tem certeza que deseja excluir este serviÃ§o?")){o(!0);try{const{error:t}=await e.from("services").delete().eq("id",s);if(t)throw t;await A()}catch(t){alert("Erro ao excluir serviÃ§o")}finally{o(!1)}}})(t.id),className:"w-8 h-8 flex items-center justify-center text-gray-600 hover:text-red-600 hover:bg-red-50 rounded-lg transition-colors cursor-pointer",title:"Excluir",children:s.jsx("i",{className:"ri-delete-bin-line"})})]})})]},t.id)})})]})}),(()=>{if(_<=1)return null;const e=[];if(_<=7)for(let s=1;s<=_;s++)e.push(s);else y<=3?e.push(1,2,3,4,"...",_):y>=_-2?e.push(1,"...",_-3,_-2,_-1,_):e.push(1,"...",y-1,y,y+1,"...",_);return s.jsxs("div",{className:"flex items-center justify-between mt-6 px-6 py-4 bg-gray-50 rounded-lg",children:[s.jsxs("div",{className:"text-sm text-gray-600",children:["Mostrando ",q+1,"-",Math.min(E,z.length)," de ",z.length," serviÃ§os"]}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsxs("button",{onClick:()=>N(e=>Math.max(1,e-1)),disabled:1===y,className:"px-4 py-2 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed transition-colors cursor-pointer flex items-center gap-2",children:[s.jsx("i",{className:"ri-arrow-left-s-line"}),s.jsx("span",{className:"hidden sm:inline",children:"Anterior"})]}),s.jsx("div",{className:"flex items-center gap-1",children:e.map((e,t)=>"..."===e?s.jsx("span",{className:"px-3 py-2 text-gray-400",children:"..."},`ellipsis-${t}`):s.jsx("button",{onClick:()=>N(e),className:"px-4 py-2 rounded-lg font-medium transition-all cursor-pointer "+(y===e?"bg-gradient-to-r from-amber-500 to-amber-600 text-white shadow-lg":"bg-white border border-gray-300 text-gray-700 hover:bg-gray-50"),children:e},e))}),s.jsxs("button",{onClick:()=>N(e=>Math.min(_,e+1)),disabled:y===_,className:"px-4 py-2 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed transition-colors cursor-pointer flex items-center gap-2",children:[s.jsx("span",{className:"hidden sm:inline",children:"PrÃ³ximo"}),s.jsx("i",{className:"ri-arrow-right-s-line"})]})]})]})})()]})}),s.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-xl p-6",children:s.jsxs("div",{className:"flex items-start gap-4",children:[s.jsx("div",{className:"w-10 h-10 flex items-center justify-center bg-blue-100 text-blue-600 rounded-lg flex-shrink-0",children:s.jsx("i",{className:"ri-information-line text-xl"})}),s.jsxs("div",{children:[s.jsx("h3",{className:"font-semibold text-blue-900 mb-2",children:"GestÃ£o de ServiÃ§os Profissionais"}),s.jsx("p",{className:"text-sm text-blue-800 leading-relaxed",children:"Aqui vocÃª pode adicionar, editar e gerenciar todos os serviÃ§os profissionais oferecidos. Configure preÃ§os, IVA, galeria de imagens (atÃ© 10 fotos), defina prazos de entrega, adicione descriÃ§Ãµes detalhadas e organize por categorias. Os serviÃ§os aparecem automaticamente na pÃ¡gina de ServiÃ§os do site e na pÃ¡gina inicial quando marcados como destaque."})]})]})}),u&&s.jsx(i,{service:b,globalVatEnabled:w,onClose:()=>{p(!1),f(null)},onSave:async()=>{p(!1),f(null),await A()}})]})}function i({service:e,globalVatEnabled:s,onClose:t,onSave:r}){return null}export{a as default};
