import{a as e,j as t,u as r,s as a}from"./index-BH-fJ4Ku.js";import{c as s,L as l,f as o,u as i}from"./react-vendor-Bx1kqAC_.js";import"./supabase-vendor-Bh6n7b__.js";function n({product:r}){const{addToCart:a}=e(),[o,i]=s.useState(!1),[n,c]=s.useState(!1);s.useEffect(()=>{const e=JSON.parse(localStorage.getItem("favorites")||"[]");c(e.includes(r.id))},[r.id]);const d=Array.isArray(r.images)&&r.images.length>0?r.images[0]:"https://readdy.ai/api/search-image?query=product%20placeholder%20image%20on%20clean%20white%20minimalist%20background&width=400&height=400&seq=placeholder&orientation=squarish";return t.jsxs("div",{className:"group bg-white dark:bg-gray-900 rounded-xl border border-gray-200 dark:border-gray-800 overflow-hidden hover:shadow-2xl transition-all duration-300 cursor-pointer hover:-translate-y-1","data-product-shop":!0,children:[t.jsx(l,{to:`/produto/${r.slug}`,className:"block",children:t.jsxs("div",{className:"relative w-full h-72 bg-gray-100 dark:bg-gray-800 overflow-hidden",children:[t.jsx("img",{src:d,alt:r.name,className:"w-full h-full object-cover object-top group-hover:scale-110 transition-transform duration-500"}),t.jsx("button",{onClick:e=>{e.preventDefault(),e.stopPropagation(),(e=>{const t=JSON.parse(localStorage.getItem("favorites")||"[]");let r;t.includes(e)?(r=t.filter(t=>t!==e),c(!1)):(r=[...t,e],c(!0)),localStorage.setItem("favorites",JSON.stringify(r)),window.dispatchEvent(new Event("favoritesChanged"))})(r.id)},className:`absolute top-4 right-4 w-12 h-12 rounded-full ${n?"bg-red-500 text-white":"bg-white/90 dark:bg-gray-800/90 text-gray-900 dark:text-white"} backdrop-blur-sm flex items-center justify-center shadow-xl transition-all duration-300 hover:scale-110 cursor-pointer z-10`,"aria-label":n?"Remover dos favoritos":"Adicionar aos favoritos",children:t.jsx("i",{className:(n?"ri-heart-fill":"ri-heart-line")+" text-2xl"})}),t.jsxs("div",{className:"absolute top-4 left-4 flex flex-col gap-2",children:[r.stock<10&&r.stock>0&&t.jsxs("div",{className:"px-3 py-1.5 bg-orange-500 text-white text-xs font-bold rounded-full shadow-lg",children:["Últimas ",r.stock]}),0===r.stock&&t.jsx("div",{className:"px-3 py-1.5 bg-red-500 text-white text-xs font-bold rounded-full shadow-lg",children:"Esgotado"}),r.compare_at_price&&r.compare_at_price>r.price&&t.jsxs("div",{className:"px-3 py-1.5 bg-green-500 text-white text-xs font-bold rounded-full shadow-lg",children:["-",Math.round((r.compare_at_price-r.price)/r.compare_at_price*100),"%"]})]})]})}),t.jsxs("div",{className:"p-5",children:[t.jsx(l,{to:`/produto/${r.slug}`,children:t.jsx("h3",{className:"text-base font-bold text-gray-900 dark:text-white line-clamp-2 mb-4 min-h-[3rem] group-hover:text-[#b62bff] dark:group-hover:text-[#ff6a00] transition-colors",children:r.name})}),t.jsx("div",{className:"mb-4",children:r.compare_at_price&&r.compare_at_price>r.price?t.jsxs("div",{className:"space-y-1",children:[t.jsx("div",{className:"flex items-center gap-2",children:t.jsxs("span",{className:"text-sm line-through text-gray-400 dark:text-gray-500",children:["€",r.compare_at_price.toFixed(2)]})}),t.jsxs("div",{className:"text-2xl font-bold bg-gradient-to-r from-[#b62bff] to-[#ff6a00] bg-clip-text text-transparent",children:["€",r.price.toFixed(2)]})]}):t.jsxs("div",{className:"text-2xl font-bold bg-gradient-to-r from-[#b62bff] to-[#ff6a00] bg-clip-text text-transparent",children:["€",r.price.toFixed(2)]})}),t.jsxs("div",{className:"flex gap-3",children:[t.jsx("button",{onClick:async e=>{e.preventDefault(),e.stopPropagation(),i(!0);try{await a(r,1)}catch(t){}finally{i(!1)}},disabled:0===r.stock||o,className:"flex-1 px-4 py-3.5 bg-gray-200 dark:bg-gray-800 hover:bg-gray-300 dark:hover:bg-gray-700 disabled:opacity-50 disabled:cursor-not-allowed text-gray-900 dark:text-white font-bold rounded-xl transition-all duration-300 cursor-pointer whitespace-nowrap flex items-center justify-center shadow-lg hover:scale-105",title:"Adicionar ao Carrinho",children:o?t.jsx("i",{className:"ri-loader-4-line animate-spin text-2xl"}):0===r.stock?t.jsx("i",{className:"ri-close-circle-line text-2xl"}):t.jsx("i",{className:"ri-shopping-cart-line text-2xl"})}),t.jsx("button",{onClick:async e=>{e.preventDefault(),e.stopPropagation();try{await a(r,1),window.REACT_APP_NAVIGATE("/cart")}catch(t){}},disabled:0===r.stock,className:"flex-1 px-4 py-3.5 bg-gradient-to-r from-[#b62bff] to-[#ff6a00] hover:shadow-2xl disabled:opacity-50 disabled:cursor-not-allowed text-white font-bold rounded-xl transition-all duration-300 cursor-pointer whitespace-nowrap flex items-center justify-center shadow-lg hover:scale-105 group",title:"Comprar Agora",children:0===r.stock?t.jsx("i",{className:"ri-close-circle-line text-2xl"}):t.jsx("i",{className:"ri-shopping-bag-3-fill text-2xl group-hover:animate-bounce"})})]})]})]})}function c(){const[e]=o(),l=i(),{darkMode:c}=r(),d=e.get("id"),[x,g]=s.useState([]),[m,b]=s.useState([]),[h,u]=s.useState(null),[p,f]=s.useState(!0),[y,j]=s.useState(""),[w,v]=s.useState([0,1e3]),[N,k]=s.useState("newest"),[C,$]=s.useState(1),[_,S]=s.useState({search:!0,categories:!0,price:!0,sort:!0});s.useEffect(()=>{A(),P()},[d,N]);const A=async()=>{try{const{data:e,error:t}=await a.from("categories").select("*").order("name");if(t)throw t;const r=await Promise.all((e||[]).map(async e=>{const{count:t}=await a.from("products").select("*",{count:"exact",head:!0}).eq("category_id",e.id);return{...e,product_count:t||0}}));if(b(r),d){const e=r.find(e=>e.id===d);u(e||null)}}catch(e){}},P=async()=>{try{f(!0);let e=a.from("products").select("*");switch(d&&(e=e.eq("category_id",d)),N){case"price_asc":e=e.order("price",{ascending:!0});break;case"price_desc":e=e.order("price",{ascending:!1});break;case"name":e=e.order("name",{ascending:!0});break;default:e=e.order("created_at",{ascending:!1})}const{data:t,error:r}=await e;if(r)throw r;g(t||[])}catch(e){}finally{f(!1)}},E=e=>{S(t=>({...t,[e]:!t[e]}))},F=x.filter(e=>{const t=e.name.toLowerCase().includes(y.toLowerCase())||e.description.toLowerCase().includes(y.toLowerCase()),r=e.price>=w[0]&&e.price<=w[1];return t&&r}),q=Math.ceil(F.length/12),L=12*(C-1),M=L+12,T=F.slice(L,M);s.useEffect(()=>{$(1)},[y,w,d,N]);const I=e=>{l(e?`/category?id=${e}`:"/category"),$(1)},O=e=>{$(e),window.scrollTo({top:0,behavior:"smooth"})};return p?t.jsx("div",{className:"min-h-screen flex items-center justify-center "+(c?"bg-[#0b0011]":"bg-gray-50"),children:t.jsxs("div",{className:"text-center",children:[t.jsx("div",{className:"inline-block animate-spin rounded-full h-16 w-16 border-t-4 border-b-4 border-[#b62bff] mb-4"}),t.jsx("p",{className:"text-lg "+(c?"text-gray-300":"text-gray-600"),children:"A carregar produtos..."})]})}):t.jsxs("div",{className:"min-h-screen "+(c?"bg-[#0b0011]":"bg-gray-50"),children:[t.jsx("div",{className:"container mx-auto px-4 py-8",children:t.jsxs("div",{className:"flex flex-col lg:flex-row gap-6",children:[t.jsxs("aside",{className:`lg:w-80 ${c?"bg-gray-900":"bg-white"} rounded-xl p-6 h-fit lg:sticky lg:top-24 shadow-lg border ${c?"border-gray-800":"border-gray-200"}`,children:[t.jsxs("h2",{className:"text-xl font-bold mb-6 "+(c?"text-white":"text-gray-900"),children:[t.jsx("i",{className:"ri-filter-3-line mr-2 text-[#b62bff]"}),"Filtros"]}),t.jsxs("div",{className:"mb-6",children:[t.jsxs("button",{onClick:()=>E("search"),className:`w-full flex items-center justify-between text-sm font-medium mb-2 ${c?"text-gray-300":"text-gray-700"} hover:text-[#b62bff] transition-colors`,children:[t.jsx("span",{children:"Pesquisar"}),t.jsx("i",{className:`ri-arrow-${_.search?"up":"down"}-s-line`})]}),_.search&&t.jsxs("div",{className:"relative",children:[t.jsx("input",{type:"text",placeholder:"Procurar produtos...",value:y,onChange:e=>j(e.target.value),className:`w-full px-4 py-2.5 pl-10 rounded-lg border ${c?"bg-gray-800 border-gray-700 text-white placeholder-gray-500":"bg-gray-50 border-gray-300 text-gray-900 placeholder-gray-400"} focus:outline-none focus:ring-2 focus:ring-[#b62bff] focus:border-transparent transition-all text-sm`}),t.jsx("i",{className:"ri-search-line absolute left-3 top-1/2 -translate-y-1/2 text-gray-400"})]})]}),t.jsxs("div",{className:"mb-6",children:[t.jsxs("button",{onClick:()=>E("categories"),className:`w-full flex items-center justify-between text-sm font-medium mb-2 ${c?"text-gray-300":"text-gray-700"} hover:text-[#b62bff] transition-colors`,children:[t.jsx("span",{children:"Categorias"}),t.jsx("i",{className:`ri-arrow-${_.categories?"up":"down"}-s-line`})]}),_.categories&&t.jsxs("div",{className:"space-y-1 max-h-64 overflow-y-auto custom-scrollbar",children:[t.jsxs("button",{onClick:()=>I(null),className:"w-full text-left px-3 py-2.5 rounded-lg transition-all text-sm flex items-center justify-between group "+(d?c?"hover:bg-gray-800 text-gray-300":"hover:bg-gray-100 text-gray-700":"bg-gradient-to-r from-[#b62bff] to-[#ff6a00] text-white"),children:[t.jsxs("span",{className:"flex items-center gap-2",children:[t.jsx("i",{className:"ri-apps-line"}),"Todas as Categorias"]}),t.jsx("span",{className:"text-xs px-2 py-0.5 rounded-full "+(d?c?"bg-gray-800":"bg-gray-200":"bg-white/20"),children:x.length})]}),m.map(e=>t.jsxs("button",{onClick:()=>I(e.id),className:"w-full text-left px-3 py-2.5 rounded-lg transition-all text-sm flex items-center justify-between group "+(d===e.id?"bg-gradient-to-r from-[#b62bff] to-[#ff6a00] text-white":c?"hover:bg-gray-800 text-gray-300":"hover:bg-gray-100 text-gray-700"),children:[t.jsxs("span",{className:"flex items-center gap-2",children:[t.jsx("i",{className:e.icon}),e.name]}),t.jsx("span",{className:"text-xs px-2 py-0.5 rounded-full "+(d===e.id?"bg-white/20":c?"bg-gray-800":"bg-gray-200"),children:e.product_count})]},e.id))]})]}),t.jsxs("div",{className:"mb-6",children:[t.jsxs("button",{onClick:()=>E("price"),className:`w-full flex items-center justify-between text-sm font-medium mb-2 ${c?"text-gray-300":"text-gray-700"} hover:text-[#b62bff] transition-colors`,children:[t.jsx("span",{children:"Faixa de Preço"}),t.jsx("i",{className:`ri-arrow-${_.price?"up":"down"}-s-line`})]}),_.price&&t.jsxs("div",{children:[t.jsxs("div",{className:"flex items-center justify-between mb-3",children:[t.jsxs("span",{className:"text-sm "+(c?"text-gray-400":"text-gray-600"),children:["€",w[0]]}),t.jsxs("span",{className:"text-sm "+(c?"text-gray-400":"text-gray-600"),children:["€",w[1]]})]}),t.jsx("input",{type:"range",min:"0",max:"1000",step:"10",value:w[1],onChange:e=>v([0,parseInt(e.target.value)]),className:"w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer accent-[#b62bff]"})]})]}),t.jsxs("div",{className:"mb-6",children:[t.jsxs("button",{onClick:()=>E("sort"),className:`w-full flex items-center justify-between text-sm font-medium mb-2 ${c?"text-gray-300":"text-gray-700"} hover:text-[#b62bff] transition-colors`,children:[t.jsx("span",{children:"Ordenar por"}),t.jsx("i",{className:`ri-arrow-${_.sort?"up":"down"}-s-line`})]}),_.sort&&t.jsxs("select",{value:N,onChange:e=>k(e.target.value),className:`w-full px-4 py-2.5 rounded-lg border ${c?"bg-gray-800 border-gray-700 text-white":"bg-gray-50 border-gray-300 text-gray-900"} focus:outline-none focus:ring-2 focus:ring-[#b62bff] focus:border-transparent transition-all text-sm cursor-pointer`,children:[t.jsx("option",{value:"newest",children:"Mais Recentes"}),t.jsx("option",{value:"price_asc",children:"Menor Preço"}),t.jsx("option",{value:"price_desc",children:"Maior Preço"}),t.jsx("option",{value:"name",children:"Nome A-Z"})]})]}),t.jsxs("button",{onClick:()=>{j(""),v([0,1e3]),k("newest"),I(null)},className:"w-full px-4 py-2.5 rounded-lg border-2 transition-all text-sm font-medium "+(c?"border-gray-700 text-gray-300 hover:bg-gray-800":"border-gray-300 text-gray-700 hover:bg-gray-100"),children:[t.jsx("i",{className:"ri-refresh-line mr-2"}),"Limpar Filtros"]})]}),t.jsxs("div",{className:"flex-1",children:[t.jsx("div",{className:`${c?"bg-gray-900":"bg-white"} rounded-xl p-6 mb-6 shadow-lg border ${c?"border-gray-800":"border-gray-200"}`,children:t.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between gap-4",children:[t.jsxs("div",{children:[t.jsx("h1",{className:"text-3xl font-bold mb-2 "+(c?"text-white":"text-gray-900"),children:h?h.name:"Todos os Produtos"}),t.jsxs("p",{className:"text-sm "+(c?"text-gray-400":"text-gray-600"),children:[F.length," ",1===F.length?"produto encontrado":"produtos encontrados"]})]}),h&&t.jsx("div",{className:"flex items-center gap-3 px-4 py-2 rounded-lg "+(c?"bg-gray-800":"bg-gray-100"),children:t.jsx("i",{className:`${h.icon} text-2xl text-[#b62bff]`})})]})}),T.length>0?t.jsxs(t.Fragment,{children:[t.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6 mb-8",children:T.map(e=>t.jsx(n,{product:e},e.id))}),q>1&&t.jsx("div",{className:`${c?"bg-gray-900":"bg-white"} rounded-xl p-6 shadow-lg border ${c?"border-gray-800":"border-gray-200"}`,children:t.jsxs("div",{className:"flex flex-col sm:flex-row items-center justify-between gap-4",children:[t.jsxs("p",{className:"text-sm "+(c?"text-gray-400":"text-gray-600"),children:["A mostrar ",L+1,"-",Math.min(M,F.length)," de ",F.length," produtos"]}),t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("button",{onClick:()=>O(C-1),disabled:1===C,className:"px-3 py-2 rounded-lg transition-all "+(1===C?c?"bg-gray-800 text-gray-600 cursor-not-allowed":"bg-gray-100 text-gray-400 cursor-not-allowed":c?"bg-gray-800 text-white hover:bg-gray-700":"bg-gray-100 text-gray-700 hover:bg-gray-200"),children:t.jsx("i",{className:"ri-arrow-left-s-line"})}),t.jsx("div",{className:"flex items-center gap-1",children:(()=>{const e=[];if(q<=5)for(let t=1;t<=q;t++)e.push(t);else if(C<=3){for(let t=1;t<=4;t++)e.push(t);e.push("..."),e.push(q)}else if(C>=q-2){e.push(1),e.push("...");for(let t=q-3;t<=q;t++)e.push(t)}else{e.push(1),e.push("...");for(let t=C-1;t<=C+1;t++)e.push(t);e.push("..."),e.push(q)}return e})().map((e,r)=>"..."===e?t.jsx("span",{className:"px-3 py-2 "+(c?"text-gray-500":"text-gray-400"),children:"..."},`ellipsis-${r}`):t.jsx("button",{onClick:()=>O(e),className:"px-3 py-2 rounded-lg transition-all min-w-[40px] "+(C===e?"bg-gradient-to-r from-[#b62bff] to-[#ff6a00] text-white font-medium":c?"bg-gray-800 text-gray-300 hover:bg-gray-700":"bg-gray-100 text-gray-700 hover:bg-gray-200"),children:e},e))}),t.jsx("button",{onClick:()=>O(C+1),disabled:C===q,className:"px-3 py-2 rounded-lg transition-all "+(C===q?c?"bg-gray-800 text-gray-600 cursor-not-allowed":"bg-gray-100 text-gray-400 cursor-not-allowed":c?"bg-gray-800 text-white hover:bg-gray-700":"bg-gray-100 text-gray-700 hover:bg-gray-200"),children:t.jsx("i",{className:"ri-arrow-right-s-line"})})]})]})})]}):t.jsxs("div",{className:`${c?"bg-gray-900":"bg-white"} rounded-xl p-12 text-center shadow-lg border ${c?"border-gray-800":"border-gray-200"}`,children:[t.jsx("i",{className:"ri-inbox-line text-6xl text-gray-400 mb-4"}),t.jsx("h3",{className:"text-xl font-bold mb-2 "+(c?"text-white":"text-gray-900"),children:"Nenhum produto encontrado"}),t.jsx("p",{className:"text-sm mb-6 "+(c?"text-gray-400":"text-gray-600"),children:"Tente ajustar os filtros ou pesquisar por outros termos"}),t.jsxs("button",{onClick:()=>{j(""),v([0,1e3]),I(null)},className:"px-6 py-3 bg-gradient-to-r from-[#b62bff] to-[#ff6a00] text-white rounded-lg hover:shadow-lg transition-all font-medium",children:[t.jsx("i",{className:"ri-refresh-line mr-2"}),"Limpar Filtros"]})]})]})]})}),t.jsx("style",{children:`\n        .custom-scrollbar::-webkit-scrollbar {\n          width: 6px;\n        }\n        .custom-scrollbar::-webkit-scrollbar-track {\n          background: ${c?"#1f2937":"#f3f4f6"};\n          border-radius: 3px;\n        }\n        .custom-scrollbar::-webkit-scrollbar-thumb {\n          background: ${c?"#4b5563":"#d1d5db"};\n          border-radius: 3px;\n        }\n        .custom-scrollbar::-webkit-scrollbar-thumb:hover {\n          background: #b62bff;\n        }\n      `})]})}export{c as default};
